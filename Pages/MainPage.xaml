<?xml version="1.0" encoding="utf-8" ?>
<!-- <ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:Food_maui.PageModels"             
             xmlns:models="clr-namespace:Food_maui.Models"
             xmlns:controls="clr-namespace:Food_maui.Pages.Controls"
             xmlns:pullToRefresh="clr-namespace:Syncfusion.Maui.Toolkit.PullToRefresh;assembly=Syncfusion.Maui.Toolkit"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="Food_maui.Pages.MainPage"
             x:DataType="pageModels:MainPageModel"
             Title="{Binding Today}">

    <ContentPage.Behaviors>
        <toolkit:EventToCommandBehavior
                EventName="NavigatedTo"
                Command="{Binding NavigatedToCommand}" />
        <toolkit:EventToCommandBehavior
                EventName="NavigatedFrom"
                Command="{Binding NavigatedFromCommand}" />
        <toolkit:EventToCommandBehavior
                EventName="Appearing"                
                Command="{Binding AppearingCommand}" />
    </ContentPage.Behaviors>

    <ContentPage.Resources>
        <ResourceDictionary>
            <toolkit:InvertedBoolConverter x:Key="InvertedBoolConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>

    <Grid>
        <pullToRefresh:SfPullToRefresh
            IsRefreshing="{Binding IsRefreshing}"
            RefreshCommand="{Binding RefreshCommand}">
            <pullToRefresh:SfPullToRefresh.PullableContent>
                <ScrollView>
                    <VerticalStackLayout Spacing="{StaticResource LayoutSpacing}" Padding="{StaticResource LayoutPadding}">

                        <controls:AddButton 
            Command="{Binding LoginCommand}" />
                        <controls:CategoryChart />
                        <Label Text="Projects" Style="{StaticResource Title2}"/>
                        <ScrollView Orientation="Horizontal" Margin="-30,0">
                            <HorizontalStackLayout 
                                Spacing="15" Padding="30,0"
                                BindableLayout.ItemsSource="{Binding Projects}">
                                <BindableLayout.ItemTemplate>
                                    <DataTemplate x:DataType="models:Project">
                                        <controls:ProjectCardView WidthRequest="200">
                                            <controls:ProjectCardView.GestureRecognizers>
                                                <TapGestureRecognizer Command="{Binding NavigateToProjectCommand, Source={RelativeSource AncestorType={x:Type pageModels:MainPageModel}}, x:DataType=pageModels:MainPageModel}" CommandParameter="{Binding .}"/>
                                            </controls:ProjectCardView.GestureRecognizers>
                                        </controls:ProjectCardView>
                                    </DataTemplate>
                                </BindableLayout.ItemTemplate>
                            </HorizontalStackLayout>
                        </ScrollView>
                        <Grid HeightRequest="44">
                            <Label Text="Tasks" Style="{StaticResource Title2}" VerticalOptions="Center"/>
                            <ImageButton 
                                Source="{StaticResource IconClean}"
                                HorizontalOptions="End"
                                VerticalOptions="Center"
                                Aspect="Center"
                                HeightRequest="44"
                                WidthRequest="44"
                                IsVisible="{Binding HasCompletedTasks}"
                                Command="{Binding CleanTasksCommand}"
                                />
                        </Grid>
                        <VerticalStackLayout Spacing="15"
                            BindableLayout.ItemsSource="{Binding Tasks}">
                            <BindableLayout.ItemTemplate>
                                <DataTemplate>
                                    <controls:TaskView TaskCompletedCommand="{Binding TaskCompletedCommand, Source={RelativeSource AncestorType={x:Type pageModels:MainPageModel}}, x:DataType=pageModels:MainPageModel}" />
                                </DataTemplate>
                            </BindableLayout.ItemTemplate>
                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </ScrollView>
            </pullToRefresh:SfPullToRefresh.PullableContent>
        </pullToRefresh:SfPullToRefresh>

        <controls:AddButton 
            IsEnabled="{Binding IsBusy, Converter={StaticResource InvertedBoolConverter}}"
            Command="{Binding AddTaskCommand}" />
    </Grid>
</ContentPage> -->


<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:pageModels="clr-namespace:Food_maui.PageModels"             
             xmlns:models="clr-namespace:Food_maui.Models"
             xmlns:controls="clr-namespace:Food_maui.Pages.Controls"
             xmlns:pullToRefresh="clr-namespace:Syncfusion.Maui.Toolkit.PullToRefresh;assembly=Syncfusion.Maui.Toolkit"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="Food_maui.Pages.MainPage"
             x:DataType="pageModels:MainPageModel"
             Title="{Binding Today}"
             Shell.NavBarIsVisible="False">

    <Grid RowDefinitions="Auto, Auto, Auto">
        
        <VerticalStackLayout Padding="0" BackgroundColor="white">
            
        </VerticalStackLayout>

        <!-- Header Section -->
        <VerticalStackLayout Padding="0" BackgroundColor="#f0f0f0">
            <Grid HorizontalOptions="Fill" VerticalOptions="Center" HeightRequest="100" BackgroundColor="White" Padding="0">
                <!-- Logo -->
                <Image Source="halal_logo.png" HeightRequest="80" VerticalOptions="Center" HorizontalOptions="Start" Margin="10,0,0,0" />

                <!-- Menu Button -->
                <Button Text="☰" FontSize="24" BackgroundColor="transparent" TextColor="Black" VerticalOptions="Center" HorizontalOptions="End"
                        Command="{Binding OpenMenuCommand}" Margin="0,0,10,0" />

                <!-- Bottom Shadow -->
                <BoxView HeightRequest="2" VerticalOptions="End" HorizontalOptions="Fill" BackgroundColor="#CCCCCC" />
            </Grid>
            <Grid ColumnDefinitions="*,Auto,*" Padding="0, 10">
                <HorizontalStackLayout HorizontalOptions="End" Grid.Column="1" Spacing="5">
                    <Button 
                        ImageSource="home_icon.png" 
                        Text="Home" 
                        BackgroundColor="#4CAF50" 
                        TextColor="White" 
                        FontSize="Default" 
                        ContentLayout="Left,0" />
                    <Button 
                        ImageSource="dollar_icon.png" 
                        Text="Today's Sales" 
                        BackgroundColor="#2196F3" 
                        TextColor="White" 
                        FontSize="Default"
                        ContentLayout="Left,0" />
                    <Button 
                        ImageSource="dollar_icon.png" 
                        Text="Sales Report" 
                        BackgroundColor="#FF5722" 
                        TextColor="White" 
                        FontSize="Default" 
                        ContentLayout="Left,0" />
                </HorizontalStackLayout>
            </Grid>

            <Label Text="Business Name: Pakwan Restaurant Hayward - Account ID: 6"
                   HorizontalOptions="Center" Padding="10" FontSize="Caption" Margin="0,5"/>
            <VerticalStackLayout Padding="10">
                <Label Text="Deliver Status"/>
                <Picker 
                    Title="All" 
                    ItemsSource="{Binding DeliveryStatuses}" 
                    SelectedItem="{Binding SelectedDeliveryStatus}" 
                    Margin="0,5" />
            </VerticalStackLayout>
            <VerticalStackLayout Padding="10" HorizontalOptions="Fill">
                <Label Text="Search"/>
                <HorizontalStackLayout Margin="0,5" HorizontalOptions="Fill">
                    <Entry Placeholder="Enter Order # and press Enter..." HorizontalOptions="Fill"
                       Text="{Binding SearchText, Mode=TwoWay}" ReturnType="Search" />
                    <ImageButton Padding="10" BackgroundColor="#2196F3" Source="search.ico" WidthRequest="20" HeightRequest="20" Command="{Binding SearchCommand}"/>
                </HorizontalStackLayout>
            </VerticalStackLayout>

            <ScrollView Orientation="Horizontal" Padding="10">
                <HorizontalStackLayout Spacing="5" Margin="0,5">
                    <Button Text="New (0)" BackgroundColor="#4CAF50" TextColor="White"/>
                    <Button Text="In Process (0)" BackgroundColor="#FFC107" TextColor="White"/>
                    <Button Text="Ready (0)" BackgroundColor="#8BC34A" TextColor="White"/>
                    <Button Text="Picked Up (0)" BackgroundColor="#03A9F4" TextColor="White"/>
                    <Button Text="Canceled (0)" BackgroundColor="#F44336" TextColor="White"/>
                    <Button Text="Scheduled (0)" BackgroundColor="#9C27B0" TextColor="White"/>
                </HorizontalStackLayout>
            </ScrollView>
        </VerticalStackLayout>

        <!-- Main Content (Image) -->
        <VerticalStackLayout Grid.Row="1" VerticalOptions="Center" HorizontalOptions="Center">
            <Label 
                Text="{Binding TodaysOrdersText}" 
                HorizontalOptions="Start" 
                Margin="0,10" 
                TextColor="Black" />
            <Image 
                Source="hd_business_orders.jpg" 
                Aspect="AspectFill" 
                WidthRequest="300" 
                HeightRequest="200" />
                
            <!-- Test Notification Button -->
            <Button 
                Text="Test Notification" 
                BackgroundColor="#673AB7" 
                TextColor="White" 
                Margin="0,20,0,0"
                Clicked="OnTestNotificationClicked" />
        </VerticalStackLayout>

        <!-- Footer -->
        <VerticalStackLayout Grid.Row="2" HorizontalOptions="Center" VerticalOptions="End" Margin="0,0,0,10" Spacing="5">
            <!-- First Part -->
            <Label 
                Text="© Copyright 2020-2025 Halal Deliveries. All Rights Reserved. (Version 24.06.05.Prod.a)" 
                HorizontalOptions="Center" 
                HorizontalTextAlignment="Center"
                Padding="30, 5"
                FontSize="Caption" 
                TextColor="Gray" />

            <!-- Second Part -->
            <HorizontalStackLayout HorizontalOptions="Center" Spacing="5">
                <Label 
                    Text="An iSofware Company" 
                    FontAttributes="Bold" 
                    TextColor="Black" 
                    FontSize="Caption" />
                <Label 
                    Text="www.iSofware.com" 
                    TextColor="Red" 
                    FontSize="Caption">
                    <Label.GestureRecognizers>
                        <TapGestureRecognizer Command="{Binding OpenWebsiteCommand}" />
                    </Label.GestureRecognizers>
                </Label>
            </HorizontalStackLayout>
        </VerticalStackLayout>
    </Grid>
</ContentPage>
